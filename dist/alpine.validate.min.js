(()=>{var B=function(D){let $="data-error",T=`${$}-msg`,N="error-msg",C="validate",M="form",k="fieldset",y='input:not([type="search"], [type="reset"], [type="submit"]),select,textarea',q="hidden",i=(t,e)=>{let n=t instanceof HTMLElement;return e?n&&t.matches(e):n},_=(t,e)=>Array.isArray(t)&&t.includes(e),F=(t,e,n)=>t.addEventListener(e,n),p=(t,e)=>t.getAttribute(e),l=(t,e,n="")=>t.setAttribute(e,n),h=(t,e=document)=>i(t)?t:e.querySelector(`#${t}`)||e.querySelector(`[name ="${t}"]`),E=t=>t&&t.closest(M),I=t=>p(t,"name")||p(t,"id"),H=t=>{let e=p(t,"id");if(e)return e;let n=`${t.tagName.toLowerCase()}-${Math.random().toString(36).substring(2,9)}`;return l(t,"id",n),n},d=t=>{let e=h(t),n=b.get(E(e));if(!n)return!1;if(i(e,M))return Object.values(n);if(i(e,k)){let o=e.querySelectorAll(y);return Object.values(n).filter(r=>Array.from(o).some(c=>r.node===c))}if(i(e,y))return n[I(e)]};function j(t,e=document){let n=e.querySelectorAll(t);if(n.length<1)return null;if(n.length<2)return n[0];let o=document.createRange();return o.setStart(n[0],0),o.setEnd(n[n.length-1],n[n.length-1].childNodes.length),o.commonAncestorContainer}let b=new WeakMap;function v(t,e,n){var c,s;let o=E(t),r=I(t);if(o&&r){b.has(o)||b.set(o,D.reactive({}));let a=b.get(o),u=t.matches(":disabled"),g=t.required;e={...a[r],name:r,node:t,value:u?"":t.value,required:g,disabled:u,...e};let A=e.value,R=t.checkValidity();if(!e.disabled&&R&&_(["checkbox","radio"],t.type)){let f=e.array||[];if(t.type==="checkbox"&&(t.checked&&!f.includes(A)&&f.push(A),t.checked||(f=f.filter(x=>x!==A))),t.type==="radio"&&t.checked&&(f=[A]),e.array=f,e.value=f.toString(),console.log("checking validation",t.name),(c=e.parentNode)==null?void 0:c.dataset.group){let x=parseInt((s=e.parentNode)==null?void 0:s.dataset.group)||1;R=f.length>=x}}e.valid=R,a[r]=e,b.set(o,a)}return n&&L(t,e.valid),e}function S(t,e,n){if((i(t,M)||i(t,k))&&d(t).forEach(r=>v(r.node)),i(t,y))return v(t,e,n)}let m={};m.data=t=>d(t),m.formData=t=>b.get(E(h(t))),m.value=(t,e)=>{t=h(t);let n=d(t);return n?Array.isArray(n)?n.reduce((o,r)=>(o[r.name]=r.value,o),{}):(e&&(n.value=e,t.value=e,v(t)),n.value):!1},m.updateData=(t,e,n)=>S(h(t),e,n),m.toggleError=(t,e)=>L(h(t),e),m.submit=t=>{let e=0;d(t.target).forEach(n=>{n=S(n.node),n.valid===!1&&(e++,e===1&&n.node.focus(),L(n.node,!1),t.preventDefault(),console.error(`${n.name} required`))})},m.isComplete=t=>{let e=d(t);return Array.isArray(e)?!e.some(n=>!n.valid):e&&e.valid},D.magic(C,()=>m),D.magic("formData",t=>b.get(E(h(t)))),D.directive(C,(t,{modifiers:e})=>{let n=r=>{let c=new MutationObserver(s=>{for(let a of s){let u=a.target;if(a.type==="attributes"){let g=a.attributeName;u.matches(y)&&["disabled","required","value"].includes(g)&&(console.log("mutation",u,g),S(u)),u.matches(k)&&g==="disabled"&&S(u)}}});return c.observe(r,{attributes:!0,childList:!0,subtree:!0}),c},o=r=>{let c;if(i(r,"[type=checkbox], [type=radio]")){let g=E(r);g.querySelectorAll(`[name=${r.name}]`).length>1&&(c=j(`[name=${r.name}]`,g))}let s=[...e,r.type],a=r.required,u=r.matches(":disabled");return{mods:s,required:a,disabled:u,parentNode:c}};if(i(t,M)){let r=t;n(r),e.includes("use-browser")||l(r,"novalidate","true"),e.includes("validate-on-submit")&&r.addEventListener("submit",function(s){m.submit(s)});let c=r.querySelectorAll(y);F(r,"reset",()=>{r.reset();let s=d(r);setTimeout(()=>{s.forEach(a=>v(a.node))},50)}),c.forEach(s=>{v(s,o(s)),V(s)}),r.addEventListener("input",s=>{let a=s.target;console.log("input",a.name),v(a),i(a,"select, input[type=checkbox], input[type=radio], input[type=range]")&&O(a)}),r.addEventListener("focusout",s=>{let a=s.target;i(a,"select, input[type=checkbox], input[type=radio], input[type=range]")||(console.log("focusout",a.name),O(a))})}});function O(t){let e=d(t);L(t,e.valid)}function L(t,e){console.log("toggleError",t,e);let n=d(t).parentNode||t,o=document.getElementById(p(t,"aria-errormessage"));l(t,"aria-invalid",!e),e?(t.setCustomValidity(""),l(o,q),n.removeAttribute($)):(o.removeAttribute(q),t.setCustomValidity("Invalid"),l(n,$,o.textContent))}function G(t){for(;t;){if(t=t.nextElementSibling,i(t,`.${N}`))return t;if(i(t,y))return!1}return!1}function V(t){let n=d(t).parentNode||t.closest("label")||t,o=document.createElement("span");o.className=N;let r=document.getElementById(`${N}-${p(n,"id")}`)||G(n)||o,c=H(n),s=`${N}-${c}`;p(r,"id")!==s&&l(r,"id",s),l(r,q);let a=I(t);r.innerHTML||(r.textContent=p(n,T)||`${a.replace(/[-_]/g," ")} required`),l(t,"aria-errormessage",s),h(s,E(t))||n.after(r)}},w=B;document.addEventListener("alpine:init",()=>{window.Alpine.plugin(w)});})();
